<!DOCTYPE html>
<html>
<head>
    <title>üåç India Disaster Prediction</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        select { padding: 10px; font-size: 16px; }
        .card { border-left: 5px solid #FF4500; padding: 20px; margin: 20px 0; }
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 30px; }
        .box { padding: 15px; color: white; text-align: center; border-radius: 8px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üåç India Disaster Prediction</h1>
    
    <select id="region" onchange="updatePrediction()">
        <option>Bihar</option>
        <option>Kerala</option>
        <option>Maharashtra</option>
        <option>Andhra Pradesh</option>
    </select>

    <div id="card" class="card"></div>
    <div id="grid" class="grid"></div>

    <script>
        async function fetchPredictions() {
            const res = await fetch('http://localhost:8000/all');
            const data = await res.json();
            
            // Show all regions
            const grid = document.getElementById('grid');
            grid.innerHTML = '';
            for (const [region, pred] of Object.entries(data.predictions)) {
                const level = pred.risk_level || 'LOW';
                const colors = {'EXTREME': '#8B0000', 'HIGH': '#FF4500', 'MEDIUM': '#FFD700', 'LOW': '#00AA00'};
                const box = document.createElement('div');
                box.className = 'box';
                box.style.backgroundColor = colors[level];
                box.textContent = region + '\n' + level;
                box.onclick = () => { document.getElementById('region').value = region; updatePrediction(); };
                grid.appendChild(box);
            }
        }

        async function updatePrediction() {
            const region = document.getElementById('region').value;
            const res = await fetch(`http://localhost:8000/predict/${region}`);
            const data = await res.json();
            const pred = data.prediction;
            
            const colors = {'EXTREME': '#8B0000', 'HIGH': '#FF4500', 'MEDIUM': '#FFD700', 'LOW': '#00AA00'};
            document.getElementById('card').innerHTML = `
                <h2>${region}</h2>
                <p><strong>Risk:</strong> <span style="color: ${colors[pred.risk_level]}">${pred.risk_level}</span></p>
                <p><strong>Primary:</strong> ${pred.primary_disaster}</p>
                <p><strong>Flood Risk:</strong> ${(pred.flood_risk*100).toFixed(0)}%</p>
                <p><strong>Heat Risk:</strong> ${(pred.heat_risk*100).toFixed(0)}%</p>
                <p><strong>Rainfall (72h):</strong> ${pred.rainfall_72h_mm}mm</p>
                <p><strong>Max Temp:</strong> ${pred.max_temperature}¬∞C</p>
                <p><strong>Alert:</strong> ${pred.alert}</p>
            `;
        }

        fetchPredictions();
        setInterval(fetchPredictions, 300000);
    </script>
</body>
</html>
